<h2 class="title text-center">ğŸ§© Sliding Puzzle Game</h2>

<!-- Stats Panel -->
<div class="puzzle-stats">
  <div>â± Time: <span class="highlight">{{ formattedTime }}</span></div>
  <div>ğŸ¯ Moves: <span class="highlight">{{ moveCount }}</span></div>
</div>

<div class="puzzle-layout">
  <!-- âœ… Left Column -->
  <div class="puzzle-left">
    <button class="btn-new-puzzle fw-bold" data-bs-toggle="modal" data-bs-target="#staticBackdrop">
      â• Create New Puzzle
    </button>

    <!-- Hint Image -->
    <div *ngIf="puzzle.originalImageUrl" class="hint">
      <h4 class="fw-bold">Hint (Original Image)</h4>
      <img [src]="puzzle.originalImageUrl" alt="Original"
           class="hint-img"
           draggable="false"
           (contextmenu)="$event.preventDefault()">
    </div>

    <!-- Difficulty -->
    <div class="difficulty-row">
      <label>
        <input type="radio" name="difficulty" value="Easy" [(ngModel)]="difficulty" (change)="onDifficultyChange()">
        <span>Easy</span>
      </label>
      <label>
        <input type="radio" name="difficulty" value="Medium" [(ngModel)]="difficulty" (change)="onDifficultyChange()">
        <span>Medium</span>
      </label>
      <label>
        <input type="radio" name="difficulty" value="Hard" [(ngModel)]="difficulty" (change)="onDifficultyChange()">
        <span>Hard</span>
      </label>
    </div>

    <!-- Controls -->
    <div class="controls">
      <button class="btn btn-success" *ngIf="!showIndices" (click)="showIndices = true">ğŸ”¢ Show Index</button>
      <button class="btn btn-warning" *ngIf="showIndices" (click)="showIndices = false">âŒ Hide Index</button>
      <button class="btn btn-info" (click)="shuffleTiles()">ğŸ”€ Shuffle</button>
    </div>

    <!-- Puzzle Solved -->
    <div *ngIf="isSolved()" class="solved-banner text-center">
      ğŸ‰ Puzzle Solved! Great Job ğŸ‰
      <br>
      <button class="btn btn-success mt-3 fw-bold" (click)="restartGame()">ğŸ”„ Restart Game</button>
    </div>
  </div>

  <!-- âœ… Right Column (Puzzle Grid) -->
  <div class="puzzle-right">
    <div class="puzzle-grid"
         [style.grid-template-columns]="'repeat(' + puzzle.cols + ', 1fr)'"
         [style.grid-template-rows]="'repeat(' + puzzle.rows + ', 1fr)'">

      <div *ngFor="let tile of tiles; let i = index"
           class="tile"
           (click)="!isSolved() && moveTile(i)"
           [class.disabled]="isSolved()">

        <ng-container *ngIf="i === emptyIndex && !isSolved(); else showTile">
          <div class="empty-tile"></div>
        </ng-container>

        <ng-template #showTile>
          <div class="tile-wrapper">
            <img [src]="tile?.url"
                 [alt]="'Tile ' + tile?.index"
                 draggable="false"
                 (contextmenu)="$event.preventDefault()">

            <span *ngIf="showIndices" class="tile-index">
              {{ tile!.index + 1 }}
            </span>
          </div>
        </ng-template>
      </div>
    </div>
  </div>
</div>
